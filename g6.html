<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Tutorial Demo</title>
</head>
<body>
/* 图的画布容器 */
<div id="mountNode"></div>

/* 引入 G6 */
<script src="https://gw.alipayobjects.com/os/antv/pkg/_antv.g6-3.7.1/dist/g6.min.js"></script>

<script>
    import G6 from '@antv/g6';

    fetch('tree.json')
        .then((res) => res.json())
        .then((data) => {
            const width = document.getElementById('container').scrollWidth;
            const height = document.getElementById('container').scrollHeight || 500;
            const graph = new G6.TreeGraph({
                container: 'container',
                width,
                height,
                modes: {
                    default: [
                        {
                            type: 'collapse-expand',
                            onChange: function onChange(item, collapsed) {
                                const data = item.get('model').data;
                                data.collapsed = collapsed;
                                return true;
                            },
                        },
                        'drag-canvas',
                        'zoom-canvas',
                    ],
                },
                defaultNode: {
                    size: 26,
                    anchorPoints: [
                        [0, 0.5],
                        [1, 0.5],
                    ],
                },
                defaultEdge: {
                    type: 'cubic-horizontal',
                },
                layout: {
                    type: 'mindmap',
                    direction: 'H',
                    getHeight: () => {
                        return 16;
                    },
                    getWidth: () => {
                        return 16;
                    },
                    getVGap: () => {
                        return 10;
                    },
                    getHGap: () => {
                        return 100;
                    },
                    getSide: () => {
                        return 'right';
                    },
                },
            });

            let centerX = 0;
            graph.node(function (node) {
                if (node.id === 'Modeling Methods') {
                    centerX = node.x;
                }

                return {
                    label: node.id,
                    labelCfg: {
                        position:
                            node.children && node.children.length > 0
                                ? 'right'
                                : node.x > centerX
                                ? 'right'
                                : 'left',
                        offset: 5,
                    },
                };
            });

            graph.data(data);
            graph.render();
            graph.fitView();
        });
</script>
</body>
</html>